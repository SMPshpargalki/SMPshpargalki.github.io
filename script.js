// –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º
function hideAllSections(){
    document.querySelectorAll('.subsections, .text-block').forEach(s => s.style.display = 'none');
}

function hideDescendants(el){
    el.querySelectorAll('.subsections, .text-block').forEach(s => s.style.display = 'none');
}

function toggleSection(id){
    const el = document.getElementById(id);
    if(!el) return;
    const visible = window.getComputedStyle(el).display !== 'none';
    if(visible){
        hideDescendants(el);
        el.style.display = 'none';
        return;
    }
    hideAllSections();
    let p = el.parentElement;
    const ancestors = [];
    while(p){
        if(p.classList && p.classList.contains('subsections') && p.id){ 
            ancestors.push(p.id); 
        }
        p = p.parentElement;
    }
    ancestors.reverse().forEach(aid => {
        const block = document.getElementById(aid);
        if(block) block.style.display = 'block';
    });
    el.style.display = 'block';
}

document.addEventListener('DOMContentLoaded', hideAllSections);

/* --- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û --- */
function openModal(text){
    document.getElementById('modalContent').innerHTML = text;
    document.getElementById('modal').style.display = 'flex';
}

function openVideo(src){
    document.getElementById('modalContent').innerHTML = `
    <video controls autoplay style="width:100%; max-height:90vh; border-radius:10px;">
        <source src="${src}" type="video/mp4">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
    </video>`;
    document.getElementById('modal').style.display = 'flex';
}

function closeModal(){
    const video = document.getElementById('modalVideo');
    if (video) {
        video.pause();
        video.currentTime = 0;
    }
    document.getElementById('modal').style.display = 'none';
}

// –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–∏–¥–µ–æ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function openVideo(url) {
    const modal = document.getElementById('modal');
    const modalContent = document.getElementById('modalContent');
    modalContent.innerHTML = `
    <video id="modalVideo" controls autoplay style="width:100%; max-height:80vh; border-radius:10px;">
        <source src="${url}" type="video/mp4">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
    </video>`;
    modal.style.display = 'flex';
}

// Service Worker
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("sw.js");
}

/* --- –£–º–Ω—ã–π –ø–æ–∏—Å–∫ + –∞–≤—Ç–æ–ø–æ–∫–∞–∑ —Ä–∞–∑–¥–µ–ª–∞ –ø–æ –∫–ª–∏–∫—É --- */
const searchInput = document.getElementById('searchInput');

// –§—É–Ω–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
function show(el){ if(el) el.style.display = 'block'; }
function hide(el){ if(el) el.style.display = 'none'; }

// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç id —Ü–µ–ª–∏ –∏–∑ —Å—Ç—Ä–æ–∫–∏ onclick —Ç–∏–ø–∞: toggleSection('obstetrics')
function parseToggleTargetFromOnclick(str){
    const m = /toggleSection\(['"]([^'"]+)['"]\)/.exec(str || '');
    return m ? m[1] : null;
}

// –ü—Ä–∏ –≤–≤–æ–¥–µ - —Ñ–∏–ª—å—Ç—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
searchInput.addEventListener('input', function(){
    const q = this.value.trim().toLowerCase();
    // –í—Å–µ –∫–Ω–æ–ø–∫–∏ (–≤–∫–ª—é—á–∞—è main/sub/child)
    const allButtons = document.querySelectorAll('.main-btn, .sub-btn, .child-btn');
    
    if(q === ''){
        // –ü—É—Å—Ç–æ–π –ø–æ–∏—Å–∫ ‚Äî –≤–µ—Ä–Ω—É—Ç—å –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        allButtons.forEach(b => b.style.display = 'block');
        // —Å–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã
        document.querySelectorAll('.subsections, .text-block').forEach(s => s.style.display = 'none');
        return;
    }
    
    // –ü—Ä–æ–π–¥–µ–º—Å—è –ø–æ –∫–Ω–æ–ø–∫–∞–º –∏ –ø–æ–º–µ—Ç–∏–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
    allButtons.forEach(btn => {
        const text = (btn.innerText || '').toLowerCase();
        if(text.includes(q)){
            btn.style.display = 'block';
        } else {
            btn.style.display = 'none';
        }
    });
    
    // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏
    document.querySelectorAll('.subsections, .text-block').forEach(s => s.style.display = 'none');
    
    // –î–ª—è –∫–∞–∂–¥–æ–π –≤–∏–¥–∏–º–æ–π –∫–Ω–æ–ø–∫–∏ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –µ—ë —Ä–æ–¥–∏—Ç–µ–ª–µ–π
    document.querySelectorAll('.main-btn, .sub-btn, .child-btn').forEach(btn => {
        if(btn.style.display === 'block'){
            // –ø–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã-—Ä–æ–¥–∏—Ç–µ–ª–∏ (—Å–µ–∫—Ü–∏–∏) –≤–≤–µ—Ä—Ö –ø–æ –¥–µ—Ä–µ–≤—É
            let p = btn.parentElement;
            while(p){
                if(p.classList && p.classList.contains('subsections')){
                    p.style.display = 'block';
                }
                p = p.parentElement;
            }
        }
    });
    
    // –°–∫—Ä—ã—Ç—å –ø—É—Å—Ç—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
    document.querySelectorAll('.subsections').forEach(sec => {
        const hasVisibleChild = Array.from(sec.querySelectorAll('.main-btn, .sub-btn, .child-btn')).some(b => b.style.display === 'block');
        if(!hasVisibleChild){
            sec.style.display = 'none';
        }
    });
});

// –ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞—é—Ç toggleSection('id')
document.querySelectorAll('[onclick]').forEach(el => {
    const onclickAttr = el.getAttribute('onclick') || '';
    const targetId = parseToggleTargetFromOnclick(onclickAttr);
    if(targetId){
        el.addEventListener('click', (e) => {
            // –ï—Å–ª–∏ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –ø—É—Å—Ç–æ–µ, –ø—Ä–æ—Å—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É onclick —Ä–∞–±–æ—Ç–∞—Ç—å
            const q = (searchInput.value || '').trim();
            if(q === ''){
                return;
            }
            
            // –ï—Å–ª–∏ –µ—Å—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å ‚Äî –ø—Ä–∏ –∫–ª–∏–∫–µ —Ä–∞—Å–∫—Ä–æ–µ–º –í–°–ï –¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ü–µ–ª–µ–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
            e.preventDefault();
            e.stopPropagation();
            
            // –°–Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–∞—à—É –ª–æ–≥–∏–∫—É: —Å–∫—Ä—ã—Ç—å –≤—Å—ë, –ø–æ–∫–∞–∑–∞—Ç—å —Ü–µ–ø–æ—á–∫—É –ø—Ä–µ–¥–∫–æ–≤ –∏ —Å–∞–º —Ä–∞–∑–¥–µ–ª
            document.querySelectorAll('.subsections, .text-block').forEach(s => s.style.display = 'none');
            const elTarget = document.getElementById(targetId);
            if(!elTarget) return;
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Ü–µ–ø–æ—á–∫—É –ø—Ä–µ–¥–∫–æ–≤
            let p = elTarget.parentElement;
            const ancestors = [];
            while(p){
                if(p.classList && p.classList.contains('subsections') && p.id){
                    ancestors.push(p.id);
                }
                p = p.parentElement;
            }
            ancestors.reverse().forEach(aid => {
                const block = document.getElementById(aid);
                if(block) block.style.display = 'block';
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Å–∞–º —Ä–∞–∑–¥–µ–ª –∏ **–≤—Å–µ—Ö** –µ–≥–æ –ø–æ—Ç–æ–º–∫–æ–≤
            function showRecursive(node){
                if(!node) return;
                node.style.display = 'block';
                node.querySelectorAll('.subsections, .text-block, .child-btn, .sub-btn').forEach(ch => ch.style.display = 'block');
            }
            showRecursive(elTarget);
        });
    }
});

// –û—á–∏—Å—Ç–∫–∞ –ø–æ–∏—Å–∫–∞
const input = document.getElementById("searchInput");
const clearBtn = document.getElementById("clearSearch");

input.addEventListener("input", () => {
    clearBtn.style.display = input.value.length > 0 ? "block" : "none";
});

clearBtn.addEventListener("click", () => {
    input.value = "";
    clearBtn.style.display = "none";
    input.dispatchEvent(new Event("input"));  // –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞
});

// --- –î–ê–ù–ù–´–ï –ò–ó –¢–ê–ë–õ–ò–¶–´ ---
const norms = {
    "–ù–æ–≤–æ—Ä–æ–∂–¥—ë–Ω–Ω—ã–µ": {girl:{h:49.5,w:3.3}, boy:{h:50.4,w:3.5}, chss:"130-140 –≤ –º–∏–Ω—É—Ç—É", chdd:"40-60 –≤ –º–∏–Ω—É—Ç—É", ad:"70/40 –º–º. —Ä—Ç. —Å—Ç."},
    "1 –º–µ—Å—è—Ü": {girl:{h:53.5,w:4.1}, boy:{h:54.5,w:4.3}, chss:"130-140 –≤ –º–∏–Ω—É—Ç—É", chdd:"40-60 –≤ –º–∏–Ω—É—Ç—É", ad:"70/40 –º–º. —Ä—Ç. —Å—Ç."},
    "2 –º–µ—Å—è—Ü–∞": {girl:{h:56.9,w:5}, boy:{h:57.7,w:5.3}, chss:"130-140 –≤ –º–∏–Ω—É—Ç—É", chdd:"40-60 –≤ –º–∏–Ω—É—Ç—É", ad:"70/40 –º–º. —Ä—Ç. —Å—Ç."},
    "3 –º–µ—Å—è—Ü–∞": {girl:{h:60.2,w:5.9}, boy:{h:61.3,w:6.2}, chss:"120-130 –≤ –º–∏–Ω—É—Ç—É", chdd:"35-40 –≤ –º–∏–Ω—É—Ç—É", ad:"85/40 –º–º. —Ä—Ç. —Å—Ç."},
    "4 –º–µ—Å—è—Ü–∞": {girl:{h:62.1,w:6.5}, boy:{h:63.8,w:6.9}, chss:"120-130 –≤ –º–∏–Ω—É—Ç—É", chdd:"35-40 –≤ –º–∏–Ω—É—Ç—É", ad:"85/40 –º–º. —Ä—Ç. —Å—Ç."},
    "5 –º–µ—Å—è—Ü–µ–≤": {girl:{h:63.9,w:7.2}, boy:{h:66.9,w:7.8}, chss:"120-130 –≤ –º–∏–Ω—É—Ç—É", chdd:"35-40 –≤ –º–∏–Ω—É—Ç—É", ad:"85/40 –º–º. —Ä—Ç. —Å—Ç."},
    "6 –º–µ—Å—è—Ü–µ–≤": {girl:{h:66.6,w:7.9}, boy:{h:67.9,w:8.7}, chss:"120-125 –≤ –º–∏–Ω—É—Ç—É", chdd:"33-35 –≤ –º–∏–Ω—É—Ç—É", ad:"90/55 –º–º. —Ä—Ç. —Å—Ç."},
    "7 –º–µ—Å—è—Ü–µ–≤": {girl:{h:67.4,w:8.1}, boy:{h:69.6,w:8.9}, chss:"120-125 –≤ –º–∏–Ω—É—Ç—É", chdd:"33-35 –≤ –º–∏–Ω—É—Ç—É", ad:"90/55 –º–º. —Ä—Ç. —Å—Ç."},
    "8 –º–µ—Å—è—Ü–µ–≤": {girl:{h:69.8,w:8.3}, boy:{h:71.2,w:9.3}, chss:"120-125 –≤ –º–∏–Ω—É—Ç—É", chdd:"33-35 –≤ –º–∏–Ω—É—Ç—É", ad:"90/55 –º–º. —Ä—Ç. —Å—Ç."},
    "9 –º–µ—Å—è—Ü–µ–≤": {girl:{h:70.6,w:9}, boy:{h:72.8,w:9.8}, chss:"120-125 –≤ –º–∏–Ω—É—Ç—É", chdd:"33-35 –≤ –º–∏–Ω—É—Ç—É", ad:"90/55 –º–º. —Ä—Ç. —Å—Ç."},
    "10 –º–µ—Å—è—Ü–µ–≤": {girl:{h:72.1,w:9.5}, boy:{h:73.9,w:10.3}, chss:"120-125 –≤ –º–∏–Ω—É—Ç—É", chdd:"30-32 –≤ –º–∏–Ω—É—Ç—É", ad:"92/56 –º–º. —Ä—Ç. —Å—Ç."},
    "11 –º–µ—Å—è—Ü–µ–≤": {girl:{h:73.6,w:9.8}, boy:{h:74.9,w:10.4}, chss:"120-125 –≤ –º–∏–Ω—É—Ç—É", chdd:"33-35 –≤ –º–∏–Ω—É—Ç—É", ad:"90/55 –º–º. —Ä—Ç. —Å—Ç."},
    "1 –≥–æ–¥": {girl:{h:74.8,w:10.1}, boy:{h:75.7,w:10.8}, chss:"120 –≤ –º–∏–Ω—É—Ç—É", chdd:"30-32 –≤ –º–∏–Ω—É—Ç—É", ad:"92/56 –º–º. —Ä—Ç. —Å—Ç."},
    "2 –≥–æ–¥–∞": {girl:{h:86.1,w:12.6}, boy:{h:88.2,w:13}, chss:"110-115 –≤ –º–∏–Ω—É—Ç—É", chdd:"26-30 –≤ –º–∏–Ω—É—Ç—É", ad:"94/56 –º–º. —Ä—Ç. —Å—Ç."},
    "3 –≥–æ–¥–∞": {girl:{h:97.3,w:14.8}, boy:{h:95.7,w:14.9}, chss:"110-115 –≤ –º–∏–Ω—É—Ç—É", chdd:"26-30 –≤ –º–∏–Ω—É—Ç—É", ad:"94/56 –º–º. —Ä—Ç. —Å—Ç."},
    "4 –≥–æ–¥–∞": {girl:{h:100.6,w:16}, boy:{h:102.4,w:17.1}, chss:"100-105 –≤ –º–∏–Ω—É—Ç—É", chdd:"24-26 –≤ –º–∏–Ω—É—Ç—É", ad:"98/56 –º–º. —Ä—Ç. —Å—Ç."},
    "5 –ª–µ—Ç": {girl:{h:109,w:18.3}, boy:{h:110.4,w:19.7}, chss:"100 –≤ –º–∏–Ω—É—Ç—É", chdd:"24-26 –≤ –º–∏–Ω—É—Ç—É", ad:"100/60 –º–º. —Ä—Ç. —Å—Ç."},
    "6 –ª–µ—Ç": {girl:{h:115.7,w:21.3}, boy:{h:115.9,w:21.9}, chss:"90-95 –≤ –º–∏–Ω—É—Ç—É", chdd:"24-26 –≤ –º–∏–Ω—É—Ç—É", ad:"100/60 –º–º. —Ä—Ç. —Å—Ç."},
    "7 –ª–µ—Ç": {girl:{h:123.6,w:24.5}, boy:{h:123.9,w:24.9}, chss:"85-92 –≤ –º–∏–Ω—É—Ç—É", chdd:"21-23 –≤ –º–∏–Ω—É—Ç—É", ad:"100/60 –º–º. —Ä—Ç. —Å—Ç."},
    "8 –ª–µ—Ç": {girl:{h:129,w:27.4}, boy:{h:129.7,w:27.8}, chss:"80-85 –≤ –º–∏–Ω—É—Ç—É", chdd:"21-23 –≤ –º–∏–Ω—É—Ç—É", ad:"100/600 –º–º. —Ä—Ç. —Å—Ç."},
    "9 –ª–µ—Ç": {girl:{h:136.9,w:31}, boy:{h:134.6,w:30.6}, chss:"80-85 –≤ –º–∏–Ω—É—Ç—É", chdd:"21-23 –≤ –º–∏–Ω—É—Ç—É", ad:"100/60 –º–º. —Ä—Ç. —Å—Ç."},
    "10 –ª–µ—Ç": {girl:{h:140.3,w:34.3}, boy:{h:140.3,w:33.7}, chss:"78-84 –≤ –º–∏–Ω—É—Ç—É", chdd:"18-21 –≤ –º–∏–Ω—É—Ç—É", ad:"105/70 –º–º. —Ä—Ç. —Å—Ç."},
    "11 –ª–µ—Ç": {girl:{h:144.5,w:37.4}, boy:{h:143.4,w:35.4}, chss:"78-84 –≤ –º–∏–Ω—É—Ç—É", chdd:"18-21 –≤ –º–∏–Ω—É—Ç—É", ad:"105/70 –º–º. —Ä—Ç. —Å—Ç."},
    "12 –ª–µ—Ç": {girl:{h:152.8,w:44}, boy:{h:150,w:41.2}, chss:"75-82 –≤ –º–∏–Ω—É—Ç—É", chdd:"18-21 –≤ –º–∏–Ω—É—Ç—É", ad:"110/70 –º–º. —Ä—Ç. —Å—Ç."},
    "13 –ª–µ—Ç": {girl:{h:156.8,w:48.5}, boy:{h:156.6,w:45.8}, chss:"75-82 –≤ –º–∏–Ω—É—Ç—É", chdd:"18-21 –≤ –º–∏–Ω—É—Ç—É", ad:"110/70 –º–º. —Ä—Ç. —Å—Ç."},
    "14 –ª–µ—Ç": {girl:{h:160.8,w:51.3}, boy:{h:162.6,w:51.2}, chss:"72-78 –≤ –º–∏–Ω—É—Ç—É", chdd:"16-18 –≤ –º–∏–Ω—É—Ç—É", ad:"120/70 –º–º. —Ä—Ç. —Å—Ç."},
    "15 –ª–µ—Ç": {girl:{h:161.9,w:54.8}, boy:{h:170.1,w:56.3}, chss:"70-72 –≤ –º–∏–Ω—É—Ç—É", chdd:"16-18 –≤ –º–∏–Ω—É—Ç—É", ad:"120/70 –º–º. —Ä—Ç. —Å—Ç."},
    "16 –ª–µ—Ç": {girl:{h:162.6,w:55.6}, boy:{h:173.6,w:62}, chss:"70-72 –≤ –º–∏–Ω—É—Ç—É", chdd:"16-18 –≤ –º–∏–Ω—É—Ç—É", ad:"120/80 –º–º. —Ä—Ç. —Å—Ç."},
    "17 –ª–µ—Ç": {girl:{h:162.9,w:56.4}, boy:{h:175.3,w:66.8}, chss:"70-72 –≤ –º–∏–Ω—É—Ç—É", chdd:"16-18 –≤ –º–∏–Ω—É—Ç—É", ad:"120/80 –º–º. —Ä—Ç. —Å—Ç."}
};

// --- –ó–ê–ü–û–õ–ù–ï–ù–ò–ï –°–ü–ò–°–ö–ê –í–û–ó–†–ê–°–¢–û–í ---
const ageSelect = document.getElementById("ageSelect");
Object.keys(norms).forEach(age => {
    const opt = document.createElement("option");
    opt.value = age;
    opt.textContent = age;
    ageSelect.appendChild(opt);
});

// --- –†–ê–°–ß–Å–¢ ---
function calculate() {
    const age = ageSelect.value;
    const gender = document.getElementById("genderSelect").value;
    const result = document.getElementById("normResult");
    if (!age || !gender) {
        result.textContent = "–í—ã–±–µ—Ä–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç –∏ –ø–æ–ª.";
        return;
    }
    const d = norms[age];
    const g = d[gender];
    result.innerHTML = `
        <b>–†–æ—Å—Ç:</b> ${g.h} —Å–º<br>
        <b>–í–µ—Å:</b> ${g.w} –∫–≥<br>
        <b>–ß–°–°:</b> ${d.chss}<br>
        <b>–ß–î–î:</b> ${d.chdd}<br>
        <b>–ê–î:</b> ${d.ad}`;
}

ageSelect.onchange = calculate;
document.getElementById("genderSelect").onchange = calculate;

// –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏
document.getElementById("calcPreg").addEventListener("click", function () {
    const lmpValue = document.getElementById("lmpDate").value;
    if (!lmpValue) {
        alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É.");
        return;
    }
    const lmp = new Date(lmpValue + "T00:00:00");
    const today = new Date();
    const now = new Date(today.getFullYear(), today.getMonth(), today.getDate());
    const diffMs = now - lmp;
    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
    const weeks = Math.floor(diffDays / 7);
    const days = diffDays % 7;
    
    // –ü–î–† = LMP + 280 –¥–Ω–µ–π
    const due = new Date(lmp);
    due.setDate(due.getDate() + 280);
    
    function formatDate(d) {
        const dd = String(d.getDate()).padStart(2, "0");
        const mm = String(d.getMonth() + 1).padStart(2, "0");
        const yyyy = d.getFullYear();
        return dd + "." + mm + "." + yyyy;
    }
    
    document.getElementById("pregWeeks").innerText = "–°—Ä–æ–∫: " + weeks + " –Ω–µ–¥–µ–ª—å " + (days > 0 ? days + " –¥–Ω–µ–π" : "");
    document.getElementById("pregDue").innerText = "–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–∞—è –¥–∞—Ç–∞ —Ä–æ–¥–æ–≤: " + formatDate(due);
    document.getElementById("pregResult").style.display = "block";
});

// –î–∞–Ω–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤
const DRUGS = {
   
    –ê–¥—Ä–µ–Ω–∞–ª–∏–Ω:{
name:"–ê–¥—Ä–µ–Ω–∞–ª–∏–Ω",synonyms:["—ç–ø–∏–Ω–µ—Ñ—Ä–∏–Ω","epinephrin","adrenalin"],type:"weight",unit:"–≤–µ—Å –≤ –∫–≥",steps:[5,10,15,20,25,30,35,40,45,50,55,60,65,70],info:["<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","–≠–ø–∏–Ω–µ—Ñ—Ä–∏–Ω; Adrenalini","–ê–º–ø—É–ª–∞ 1–º–≥/–º–ª - 1–º–ª","<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.01–º–≥/–∫–≥","–≠–Ω–¥–æ—Ç—Ä–∞—Ö–µ–∞–ª—å–Ω–æ - 0.1–º–≥/–∫–≥","<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","–†–∞–∑–æ–≤–∞—è ‚Äì 1–º–≥","<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç"],
table:{5:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.05–º–≥-0.05–º–ª","–≠–Ω–¥–æ—Ç—Ä–∞—Ö–µ–∞–ª—å–Ω–æ 0.5–º–≥-0.5–º–ª"],10:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.1–º–≥-0.1–º–ª","–≠–Ω–¥–æ—Ç—Ä–∞—Ö–µ–∞–ª—å–Ω–æ 1–º–≥-1–º–ª"],15:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.15–º–≥-0.15–º–ª"],20:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.2–º–≥-0.2–º–ª"],25:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.25–º–≥-0.25–º–ª"],30:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.3–º–≥-0.3–º–ª"],35:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.35–º–≥-0.35–º–ª"],40:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.4–º–≥-0.4–º–ª"],45:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.45–º–≥-0.45–º–ª"],50:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.5–º–≥-0.5–º–ª"],55:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.55–º–≥-0.55–º–ª"],60:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.6–º–≥-0.6–º–ª"],65:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.65–º–≥-0.65–º–ª"],70:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.7–º–≥-0.7–º–ª"],}},

    –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π–£–≥–æ–ª—å:{
name:"–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É–≥–æ–ª—å",synonyms:["—É–≥–æ–ª—å"],type:"weight",unit:"–≤–µ—Å –≤ –∫–≥",steps:[5,10,15,20,25,30,35,40,45,50,55,60,65,70],info:["<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","Carbonis activati","–¢–∞–±–ª–µ—Ç–∫–∞-250–º–≥","<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–í–Ω—É—Ç—Ä—å 50 –º–≥/–∫–≥","<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","–°—É—Ç–æ—á–Ω–∞—è ‚Äì 200–º–≥/–∫–≥","<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç."],
table:{5:["1 —Ç–∞–±–ª–µ—Ç–∫–∞ - 250–º–≥"],10:["2 —Ç–∞–±–ª–µ—Ç–∫–∏ - 500–º–≥"],15:["3 —Ç–∞–±–ª–µ—Ç–∫–∏ - 750–º–≥"],20:["4 —Ç–∞–±–ª–µ—Ç–∫–∏ - 1000–º–≥"],25:["5 —Ç–∞–±–ª–µ—Ç–æ–∫ - 1250–º–≥"],30:["6 —Ç–∞–±–ª–µ—Ç–æ–∫ - 1500–º–≥"],35:["7 —Ç–∞–±–ª–µ—Ç–æ–∫ - 1750–º–≥"],40:["8 —Ç–∞–±–ª–µ—Ç–æ–∫ - 2000–º–≥"],45:["9 —Ç–∞–±–ª–µ—Ç–æ–∫ - 2250–º–≥"],50:["10 —Ç–∞–±–ª–µ—Ç–æ–∫ - 2500–º–≥"],55:["11 —Ç–∞–±–ª–µ—Ç–æ–∫ - 2750–º–≥"],60:["12 —Ç–∞–±–ª–µ—Ç–æ–∫ - 3000–º–≥"],65:["13 —Ç–∞–±–ª–µ—Ç–æ–∫ - 3250–º–≥"],70:["14 —Ç–∞–±–ª–µ—Ç–æ–∫ - 3500–º–≥"],}},

    –ê–º–∏–Ω–æ—Ñ–∏–ª–ª–∏–Ω:{
name:"–ê–º–∏–Ω–æ—Ñ–∏–ª–ª–∏–Ω",synonyms:["–≠—É—Ñ–∏–ª–ª–∏–Ω","euphyllin"],type:"weight",unit:"–≤–µ—Å –≤ –∫–≥",steps:[5,10,15,20,25,30,35,40,45,50,55,60,65,70],info:["<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","–ê–º–∏–Ω–æ—Ñ–∏–ª–ª–∏–Ω; Euphyllini","–ê–º–ø—É–ª–∞ 24–º–≥/–º–ª ‚Äì 10–º–ª","<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 3 –º–≥/–∫–≥ –∏–ª–∏ 0.13–º–ª","<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","–°—É—Ç–æ—á–Ω–∞—è - 15–º–≥/–∫–≥","<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç"],
table:{5:["15–º–≥-0.6–º–ª"],10:["30–º–≥-1.3–º–ª"],15:["45–º–≥-1.9–º–ª"],20:["60–º–≥-2.5–º–ª"],25:["75–º–≥-3.1–º–ª"],30:["90–º–≥-3.8–º–ª"],35:["105–º–≥-4.4–º–ª"],40:["120–º–≥-5–º–ª"],45:["135–º–≥-5.6–º–ª"],50:["150–º–≥-6.3–º–ª"],55:["165–º–≥-6.9–º–ª"],60:["180–º–≥-7.5–º–ª"],65:["195–º–≥-8.1–º–ª"],70:["210–º–≥-8.8–º–ª"],}},

    –ê–º–∏–æ–¥–∞—Ä–æ–Ω:{
name:"–ê–º–∏–æ–¥–∞—Ä–æ–Ω",synonyms:["–∫–æ—Ä–¥–∞—Ä–æ–Ω","Amiodaron"],type:"weight",unit:"–≤–µ—Å –≤ –∫–≥",steps:[5,10,15,20,25,30,35,40,45,50,55,60,65,70],info:["<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","–ê–º–∏–æ–¥–∞—Ä–æ–Ω; Amiodaron","–ê–º–ø—É–ª–∞ 50–º–≥/–º–ª ‚Äì 3–º–ª","<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 5–º–≥/–∫–≥ –∏–ª–∏ 0.1–º–ª/–∫–≥","<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","–†–∞–∑–æ–≤–∞—è ‚Äì –Ω–µ –±–æ–ª–µ–µ 300–º–≥","–°—É—Ç–æ—á–Ω–∞—è ‚Äì 600–º–≥","<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç"],
table:{5:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 25–º–≥-0.5–º–ª"],10:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 50–º–≥-1–º–ª"],15:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 75–º–≥-1.5–º–ª"],20:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 100–º–≥-2–º–ª"],25:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 125–º–≥-2.5–º–ª"],30:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 150–º–≥-3–º–ª"],35:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 175–º–≥-3.5–º–ª"],40:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 200–º–≥-4–º–ª"],45:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 225–º–≥-4.5–º–ª"],50:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 250–º–≥-5–º–ª"],55:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 275–º–≥-5.5–º–ª"],60:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 300–º–≥-6–º–ª"],65:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 325–º–≥-6.5–º–ª"],70:["–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 350–º–≥-7–º–ª"],}},

    –ê–Ω–∞–ª—å–≥–∏–Ω:{
name:"–ê–Ω–∞–ª—å–≥–∏–Ω",synonyms:["analgini","–º–µ—Ç–∞–º–∏–∑–æ–ª –Ω–∞—Ç—Ä–∏—è"],type:"weight",unit:"–≤–µ—Å –≤ –∫–≥",steps:[5,10,15,20,25,30,35,40,45,50,55,60,65,70],info:["<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","–ê–Ω–∞–ª—å–≥–∏–Ω; –ú–µ—Ç–∞–º–∏–∑–æ–ª –Ω–∞—Ç—Ä–∏—è","–ê–º–ø—É–ª–∞ 500–º–≥/–º–ª ‚Äì 2–º–ª","<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ; –≤–Ω—É—Ç—Ä–∏–º—ã—à–µ—á–Ω–æ","10–º–≥/–∫–≥ –∏–ª–∏ 0.02–º–ª/–∫–≥","<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç"],
table:{5:["50–º–≥-0.1–º–ª"],10:["100–º–≥-0.2–º–ª"],15:["150–º–≥-0.3–º–ª"],20:["200–º–≥-0.4–º–ª"],25:["250–º–≥-0.5–º–ª"],30:["300–º–≥-0.6–º–ª"],35:["350–º–≥-0.7–º–ª"],40:["400–º–≥-0.8–º–ª"],45:["450–º–≥-0.9–º–ª"],50:["500–º–≥-1–º–ª"],55:["550–º–≥-1.1–º–ª"],60:["600–º–≥-1.2–º–ª"],65:["650–º–≥-1.3–º–ª"],70:["700–º–≥-1.4–º–ª"],}},

–ê—Å–ø–∏—Ä–∏–Ω:{
name:"–ê—Å–ø–∏—Ä–∏–Ω",
synonyms:["–ê—Ü–µ—Ç–∏–ª—Å–∞–ª–∏—Ü–∏–ª–æ–≤–∞—è –∫–∏—Å–ª–æ—Ç–∞","aspirin","Acidi acetylsalicylici"],
type:"text",
info:[
"<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","–ê—Ü–µ—Ç–∏–ª—Å–∞–ª–∏—Ü–∏–ª–æ–≤–∞—è –∫–∏—Å–ª–æ—Ç–∞","Acidi acetylsalicylici","–¢–∞–±–ª–µ—Ç–∫–∞-500–º–≥",
"<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–í–Ω—É—Ç—Ä—å 30–º–≥/–∫–≥",
"<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","0.5-1 —Ç–∞–±–ª–µ—Ç–∫–∞ –Ω–∞ –ø—Ä–∏–µ–º","–î–æ 6 —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏",
"<b>–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–†–∞–∑—Ä–µ—à–µ–Ω–æ —Å 16 –ª–µ—Ç"],},

–ê—Ç—Ä–æ–ø–∏–Ω:{
name:"–ê—Ç—Ä–æ–ø–∏–Ω",
synonyms:["atropin"],
type:"weight",unit:"–≤–µ—Å –≤ –∫–≥",steps:[5,10,15,20,25,30,35,40,45,50,55,60,65,70],info:[
"<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","–ê—Ç—Ä–æ–ø–∏–Ω; Atropini sulfatis","–ê–º–ø—É–ª–∞ 1–º–≥/–º–ª-1–º–ª",
"<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–ü–æ–¥–∫–æ–∂–Ω–æ; –≤/–≤–µ–Ω–Ω–æ; –≤/–º—ã—à–µ—á–Ω–æ","0.01–º–≥/–∫–≥","0,1–º–ª –Ω–∞ –∫–∞–∂–¥—ã–µ 10–∫–≥",
"<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","–°—É—Ç–æ—á–Ω–∞—è 3–º–ª - 3–º–≥",
"<b>–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç"],
table:{
5:["0.05–º–≥-0.05–º–ª"],
10:["0.1–º–≥-0.1–º–ª"],
15:["0.15–º–≥-0.15–º–ª"],
20:["0.2–º–≥-0.2–º–ª"],
25:["0.25–º–≥-0.25–º–ª"],
30:["0.3–º–≥-0.3–º–ª"],
35:["0.35–º–≥-0.35–º–ª"],
40:["0.4–º–≥-0.4–º–ª"],
45:["0.45–º–≥-0.45–º–ª"],
50:["0.5–º–≥-0.5–º–ª"],
55:["0.55–º–≥-0.55–º–ª"],
60:["0.6–º–≥-0.6–º–ª"],
65:["0.65–º–≥-0.65–º–ª"],
70:["0.7–º–≥-0.7–º–ª"],}},

–ë—É–¥–µ—Å–æ–Ω–∏–¥:{
name:"–ë—É–¥–µ—Å–æ–Ω–∏–¥",
synonyms:["–ø—É–ª—å–º–∏–∫–æ—Ä—Ç","–±—É–¥–µ–Ω–∏—Ç","pulmicort","budesonid"],
type:"text",
info:[
"<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","–ë—É–¥–µ—Å–æ–Ω–∏–¥; –ü—É–ª—å–º–∏–∫–æ—Ä—Ç","–ù–µ–±—É–ª–∞ 0.5–º–≥/–º–ª-2–º–ª",
"<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–ò–Ω–≥–∞–ª—è—Ü–∏–æ–Ω–Ω–æ 0.5-1–º–≥","–ü–æ 1-2 –Ω–µ–±—É–ª—ã –¥–æ 2-—Ö —Ä–∞–∑ –≤ –¥–µ–Ω—å",
"<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","–°—É—Ç–æ—á–Ω–∞—è 2–º–≥",
"<b>–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–†–∞–∑—Ä–µ—à–µ–Ω–æ —Å 6 –º–µ—Å—è—Ü–µ–≤"],},

–í–µ—Ä–∞–ø–∞–º–∏–ª:{
name:"–í–µ—Ä–∞–ø–∞–º–∏–ª",
synonyms:["verapamil"],
type:"weight",unit:"–≤–µ—Å –≤ –∫–≥",steps:[5,10,15,20,25,30,35,40,45,50,55,60,65,70],info:[
"<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","–í–µ—Ä–∞–ø–∞–º–∏–ª; Verapamil","–ê–º–ø—É–ª–∞ 2.5–º–≥/–º–ª-2–º–ª",
"<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ 0.1–º–≥/–∫–≥","0,4–º–ª –Ω–∞ –∫–∞–∂–¥—ã–µ 10 –∫–≥",
"<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","–°—É—Ç–æ—á–Ω–∞—è 10–º–≥",
"<b>–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç"],
table:{
5:["0.5–º–≥-0.2–º–ª"],
10:["1–º–≥-0.4–º–ª"],
15:["1.5–º–≥-0.6–º–ª"],
20:["2–º–≥-0.8–º–ª"],
25:["2.5–º–≥-1–º–ª"],
30:["3–º–≥-1.2–º–ª"],
35:["3.5–º–≥-1.4–º–ª"],
40:["4–º–≥-1.6–º–ª"],
45:["4.5–º–≥-1.8–º–ª"],
50:["5–º–≥-2–º–ª"],
55:["5.5–º–≥-2.2–º–ª"],
60:["6–º–≥-2.4–º–ª"],
65:["6.5–º–≥-2.6–º–ª"],
70:["7–º–≥-2.8–º–ª"],}},

–ì–µ–ø–∞—Ä–∏–Ω:{
name:"–ì–µ–ø–∞—Ä–∏–Ω",
synonyms:["heparini"],
type:"weight",unit:"–≤–µ—Å –≤ –∫–≥",steps:[5,10,15,20,25,30,35,40,45,50,55,60,65,70],info:[
"<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","–ì–µ–ø–∞—Ä–∏–Ω; Heparini","–ê–º–ø—É–ª–∞ 5000–ú–ï/–º–ª-1–º–ª",
"<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–í–Ω—É—Ç—Ä–∏–≤–µ–Ω–Ω–æ; –ø–æ–¥–∫–æ–∂–Ω–æ","75–ï–î/–∫–≥ –∏–ª–∏ 0,015 –º–ª/–∫–≥",
"<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","–°—É—Ç–æ—á–Ω–∞—è","1-3 –º–µ—Å—è—Ü–∞ 800–ï–î/–ö–≥","4-12 –º–µ—Å—è—Ü–µ–≤ 700–ï–î/–∫–≥","–°—Ç–∞—Ä—à–µ 1 –≥–æ–¥–∞ 500–ï–î/–∫–≥",
"<b>–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç"],
table:{
5:["375–ú–ï-0.07–º–ª"],
10:["750–ú–ï-0.15–º–ª"],
15:["1125–ú–ï-0.22–º–ª"],
20:["1500–ú–ï-0.3–º–ª"],
25:["1875–ú–ï-0.37–º–ª"],
30:["2250–ú–ï-0.45–º–ª"],
35:["2625–ú–ï-0.52–º–ª"],
40:["3000–ú–ï-0.6–º–ª"],
45:["3375–ú–ï-0.67–º–ª"],
50:["3750–ú–ï-0.75–º–ª"],
55:["4125–ú–ï-0.82–º–ª"],
60:["4500–ú–ï-0.9–º–ª"],
65:["4875–ú–ï-0.97–º–ª"],
70:["5000–ú–ï-1–º–ª"],}},

–ì–≠–ö:{
name:"–ì–≠–ö 6%",
synonyms:["–ì–∏–¥—Ä–æ–∫—Å–∏—ç—Ç–∏–ª–∫—Ä–∞—Ö–º–∞–ª","hydroxyethylamyl"],
type:"weight",unit:"–≤–µ—Å –≤ –∫–≥",steps:[5,10,15,20,25,30,35,40,45,50],info:[
"<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","–ì–≠–ö 6%","–ì–∏–¥—Ä–æ–∫—Å–∏—ç—Ç–∏–ª–∫—Ä–∞—Ö–º–∞–ª","–§–ª–∞–∫–æ–Ω - 250–º–ª",
"<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–ò–Ω—Ñ—É–∑–∏–æ–Ω–Ω–æ 10-15–º–ª/–∫–≥","–§–ª–∞–∫–æ–Ω –Ω–∞ 20-25 –∫–≥",
"<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","–°—É—Ç–æ—á–Ω–∞—è 33–º–≥/–∫–≥",
"<b>–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç"],
table:{
5:["–û—Ç 50–º–ª –¥–æ 75–º–ª"],
10:["–û—Ç 100–º–ª –¥–æ 150–º–ª"],
15:["–û—Ç 150–º–ª –¥–æ 225–º–ª"],
20:["–û—Ç 200–º–ª –¥–æ 300–º–ª"],
25:["–û—Ç 250–º–ª –¥–æ 375–º–ª"],
30:["–û—Ç 300–º–ª –¥–æ 450–º–ª"],
35:["–û—Ç 350–º–ª –¥–æ 525–º–ª"],
40:["–û—Ç 400–º–ª –¥–æ 600–º–ª"],
45:["450–º–ª"],
50:["500–º–ª"],}},

    –î–º–∞–∑–µ–ø–∞–º:{
        name:"–î–∏–∞–∑–µ–ø–∞–º",
        synonyms:["–†–µ–ª–∞–Ω–∏—É–º","–°–∏–±–∞–∑–æ–Ω","Relanium","Diazepam","Sibazon"],
        type:"weight",
        unit:"–≤–µ—Å –≤ –∫–≥",
        steps:[5,10,15,20,25,30,35,40,45,50],
        info:["<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>","Diazepami; Relanii; Sibazoni","<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</b>","5–º–≥/–º–ª - 2–º–ª","<b>–î–æ–∑–∏—Ä–æ–≤–∫–∞ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","0,2-0,5 –º–≥/–∫–≥ - –≤/–≤–µ–Ω–Ω–æ","0,5 –º–≥/–∫–≥ - –≤/–º—ã—à–µ—á–Ω–æ","<b>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–æ–≤–∞—è –¥–æ–∑–∞:</b>","–¥–æ 5 –ª–µ—Ç - 5–º–≥","—Å—Ç–∞—Ä—à–µ 5 –ª–µ—Ç - 10–º–≥","<b>–ú–µ—Ç–æ–¥ –≤–≤–µ–¥–µ–Ω–∏—è:</b>","–í/–≤ –º–µ–¥–ª–µ–Ω–Ω–æ –Ω–µ –º–µ–Ω–µ–µ 2—Ö –º–∏–Ω—É—Ç.","–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5-15 –º–∏–Ω—É—Ç, –≤ —Ä–∞–∑–æ–≤–æ–π –¥–æ–∑–µ.","<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</b>","–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç."],
        table:{5:["–æ—Ç 1–º–≥-0.2–º–ª","–¥–æ 2.5–º–≥-0.5–º–ª"],
               10:["–æ—Ç 2–º–≥-0.4–º–ª –¥–æ 5–º–≥-1.0–º–ª"],
               15:["3 –º–≥ / 0.6 –º–ª","7.5 –º–≥ / 1.5 –º–ª"],
               20:["4 –º–≥ / 0.8 –º–ª","10 –º–≥ / 2.0 –º–ª"],
               25:["5 –º–≥ / 1.0 –º–ª","10 –º–≥ / 2.0 –º–ª"],}},

    –ö–µ—Ç–∞–º–∏–Ω:{
        name:"–ö–µ—Ç–∞–º–∏–Ω",
        synonyms:["ketamin"],
        type:"weight",
        unit:"–≤–µ—Å –≤ –∫–≥",
        steps:[5,10,15,20,25,30,35,40,45,50],
        info:["<b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b>"],
        table:{5:["–æ—Ç 1–º–≥-0.2–º–ª","–¥–æ 2.5–º–≥-0.5–º–ª"],
               10:["–æ—Ç 2–º–≥-0.4–º–ª –¥–æ 5–º–≥-1.0–º–ª"],
               15:["3 –º–≥ / 0.6 –º–ª","7.5 –º–≥ / 1.5 –º–ª"],
               20:["4 –º–≥ / 0.8 –º–ª","10 –º–≥ / 2.0 –º–ª"],
               25:["5 –º–≥ / 1.0 –º–ª","10 –º–≥ / 2.0 –º–ª"],}},

    –î—Ä–æ—Ç–∞–≤–µ—Ä–∏–Ω:{
        name:"–î—Ä–æ—Ç–∞–≤–µ—Ä–∏–Ω",
        synonyms:["–ù–æ-—à–ø–∞","–ù–æ—à–ø–∞","No-spa","Drotaverine"],
        info:["–í–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç"],
        type:"age",
        unit:"–≤–æ–∑—Ä–∞—Å—Ç –≤ –≥–æ–¥–∞—Ö",
        steps:[1,2,3,4,5,6,7,8,9,10,11,12],
        table:{1:["–æ—Ç 0.1–º–ª –¥–æ 0.2 –º–ª"],
               2:["0.2 ‚Äî 0.4 –º–ª"],
               3:["0.3 ‚Äî 0.6 –º–ª"],
               10:["1.0 ‚Äî 2.0 –º–ª"],
               12:["1.2 ‚Äî 2.0 –º–ª"],}},

    –ù–∞—Ç—Ä–∏—è–•–ª–æ—Ä–∏–¥:{
        name:"–ù–∞—Ç—Ä–∏—è –•–ª–æ—Ä–∏–¥",
        synonyms:["–ù–∞—Ç—Ä–∏–π"],
        type:"text",
        info:["0.02 –º–≥/–∫–≥","–Ω–µ –±–æ–ª–µ–µ 0.6 –º–≥ –∑–∞ —Ä–∞–∑","–≤/–≤ –∏–ª–∏ –≤/–º"],}
};

// –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤
const $ = id => document.getElementById(id);

const drugSearch = $("drugSearch");
const drugList = $("drugList");
const drugParam = $("drugParam");
const drugInfo = $("drugInfo");
const drugResult = $("drugResult");
const btnToggle = $("drugListToggle");

let selectedKey = null;

// ========== –ø–æ–∫–∞–∑–∞—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫ ==========
btnToggle.onclick = () => {
    drugList.innerHTML = "";
    Object.entries(DRUGS).forEach(([key,data]) => {
        drugList.innerHTML += `<option value="${key}">${data.name}</option>`;
    });
    drugList.style.display = "block";
};

// ========== –ø–æ–∏—Å–∫ –±–µ–∑ enter ==========
drugSearch.addEventListener("input", () => {
    const q = drugSearch.value.trim().toLowerCase();
    resetCalc();
    if(!q){
        drugList.style.display = "none";
        return;
    }
    drugList.innerHTML = "";
    drugList.style.display = "block";
    Object.entries(DRUGS).forEach(([key,data]) => {
        if(data.name.toLowerCase().includes(q) ||
           data.synonyms.some(n => n.toLowerCase().includes(q))
        ){
            drugList.innerHTML += `<option value="${key}">${data.name}</option>`;
        }
    });
});

// ========== –≤—ã–±–æ—Ä –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ ==========
drugList.addEventListener("change", () => {
    resetCalc();
    selectedKey = drugList.value;
    const drug = DRUGS[selectedKey];
    drugSearch.value = drug.name;
    drugList.style.display = "none";
    showInfo(drug);
    if(drug.type === "text") return;
    fillParams(drug);
});

btnToggle.addEventListener("click", () => {
    resetCalc();
});

// ========== –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–ø—Ä–∞–≤–∫—É ==========
function showInfo(drug){
    drugInfo.innerHTML = drug.info.join("<br>");
    drugInfo.style.display = "block";
}

// ========== –≤—ã–≤–æ–¥ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤–µ—Å–∞/–≤–æ–∑—Ä–∞—Å—Ç–∞ ==========
function fillParams(drug){
    drugParam.innerHTML = "";
    drugParam.style.display = "block";
    const label = `–í—ã–±–µ—Ä–∏—Ç–µ ${drug.unit}`;
    drugParam.innerHTML += `<option value="">${label}</option>`;
    drug.steps.forEach(v => {
        drugParam.innerHTML += `<option value="${v}">${v}</option>`;
    });
}

// ========== –≤—ã–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (–≤–µ—Å/–≤–æ–∑—Ä–∞—Å—Ç) ==========
drugParam.addEventListener("change", () => {
    if(!selectedKey) return;
    const drug = DRUGS[selectedKey];
    const v = drugParam.value;
    const row = drug.table[v];
    if(!row) return;
    drugResult.innerHTML = row.join("<br>");
    drugResult.style.display = "block";
});

// ========== –æ—á–∏—Å—Ç–∫–∞ ==========
function resetCalc(){
    selectedKey = null;
    drugParam.style.display = "none";
    drugParam.innerHTML = "";
    drugInfo.style.display = "none";
    drugInfo.innerHTML = "";
    drugResult.style.display = "none";
    drugResult.innerHTML = "";
}

drugSearch.addEventListener("input", () => {
    if(!drugSearch.value.trim()) resetCalc();
});


const themeToggle = document.getElementById("themeToggle");

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–º—É (true = dark)
function setTheme(isDark){
    if(isDark){
        document.body.classList.add("dark");
        themeToggle.textContent = "‚òÄÔ∏è"; // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–ª–Ω—Ü–µ
        localStorage.setItem("theme", "dark");
    } else {
        document.body.classList.remove("dark");
        themeToggle.textContent = "üåô"; // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª—É–Ω—É
        localStorage.setItem("theme", "light");
    }
}

// –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É
setTheme(localStorage.getItem("theme") === "dark");

// –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º
themeToggle.onclick = () => {
    setTheme(!document.body.classList.contains("dark"));
};
